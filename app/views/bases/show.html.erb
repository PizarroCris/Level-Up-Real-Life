<div class="player-hud">
  <h1><%= @profile.username %>'s Base (Level <%= @profile.level %>)</h1>
  <div class="resources">
    <span>ğŸŒ² Wood: <%= @profile.wood %></span>
    <span>â›°ï¸ Stone: <%= @profile.stone %></span>
    <span>ğŸ”© Metal: <%= @profile.metal %></span>
  </div>
</div>

<div class="base-container">
  <% @plots.each do |plot| %>
    <% building = @buildings_by_plot_id[plot.id] %>

    <div class="plot-area <%= building ? 'building-plot' : 'empty-plot' %>"
      style="top: <%= plot.top_percent %>%; left: <%= plot.left_percent %>%;"
    >
      <% if building %>
        <%= link_to building_path(building) do %>
          <%
            folder_name = building.building_type.pluralize
            file_name_base = building.building_type
            level_formatted = format('%02d', building.level)
            image_path = "buildings/#{folder_name}/#{file_name_base}#{level_formatted}.png"
          %>
          <%= image_tag image_path, alt: "#{building.building_type.capitalize} Level #{building.level}" %>
          <div class="building-level-badge"><%= building.level %></div>
        <% end %>
      <% else %>
        <%= link_to new_building_path(plot_id: plot.id) do %>
          <span>+</span>
        <% end %>
      <% end %>
    </div>
  <% end %>
</div>
