<% if @building.building_type == "castle" %>
  <!-- Castle layout -->
  <div class="header-card d-flex justify-content-center">
    <p class="card-border mt-5">
      <strong>Castle</strong> <em>(Level <%= @building.level %>)</em>
    </p>
  </div>

  <div class="container">
    <div class="card card-box mt-5 rounded-5">
      <!-- Close button -->
      <div class="container-close">
        <%= link_to "<i class='fa-solid fa-square-xmark'></i>".html_safe,
                    user_base_path,
                    class: "close-btn" %>
      </div>

      <div class="resource-preview">
        <div class="image-and-button-wrapper">
          <%= image_tag @building.image_asset_path,
                        class: "resource-image",
                        alt: "Castle Level #{@building.level}" %>

          <% if @building.level < Building::CASTLE_MAX_LEVEL %>
            <div class="upgrade-button-overlay">
              <%= button_to "<i class='fa-solid fa-circle-up'></i> Upgrade".html_safe,
                            upgrade_building_path(@building, return: "castle"),
                            method: :patch,
                            class: "btn btn-red btn-sm" %>
            </div>
          <% end %>
        </div>

        <div class="production-info">
          <strong>Attack:</strong> <%= Building::CASTLE_ATTACK_BY_LEVEL[@building.level] %><br>
          <strong>Defense:</strong> <%= Building::CASTLE_DEFENSE_BY_LEVEL[@building.level] %>
        </div>
      </div>

      <div class="resource-stats-table">
        <table class="table table-striped table-hover">
          <thead>
            <tr class="table-color">
              <th>Level</th>
              <th>Defense</th>
              <th>Attack</th>
            </tr>
          </thead>
          <tbody>
            <% (1..Building::CASTLE_MAX_LEVEL).each do |lvl| %>
              <tr class="<%= 'table-info' if lvl == @building.level %>">
                <td><%= lvl %></td>
                <td><%= Building::CASTLE_DEFENSE_BY_LEVEL[lvl] %></td>
                <td><%= Building::CASTLE_ATTACK_BY_LEVEL[lvl] %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>

    </div>
  </div>

<% else %>
  <!-- Non-castle fallback (since mines/sawmills/quarries have their own routes/pages) -->
  <div class="header-card d-flex justify-content-center">
    <p class="card-border mt-5"><strong><%= @building.building_type.titleize %></strong> <em>(Level <%= @building.level %>)</em></p>
  </div>

  <div class="container">
    <div class="card card-box mt-5 rounded-5">
      <div class="container-close">
        <%= link_to "<i class='fa-solid fa-square-xmark'></i>".html_safe,
                    user_base_path,
                    class: "close-btn" %>
      </div>

      <div class="p-4">
        <p>
          This building type has a dedicated page:
          <% case @building.building_type %>
            <% when "mine" %>
              <%= link_to "Go to Mine", building_mine_path(@building) %>
            <% when "sawmill" %>
              <%= link_to "Go to Sawmill", building_sawmill_path(@building) %>
            <% when "quarry" %>
              <%= link_to "Go to Quarry", building_quarry_path(@building) %>
            <% else %>
              <em>No specific page available.</em>
          <% end %>
        </p>
      </div>
    </div>
  </div>
<% end %>
